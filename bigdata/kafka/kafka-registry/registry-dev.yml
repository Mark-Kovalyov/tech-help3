version: '3.9'
services:
  registry-db:
    container_name: messaging-hub-registry-db
    image: mysql:5.7.17
    ports:
      - 3307:3306
    volumes:
      - ./containers/registry-db/schema.sql:/docker-entrypoint-initdb.d/schema.sql
    networks:
      - dp-messaging-hub-registry-net
    environment:
      MYSQL_ROOT_PASSWORD: password
      MYSQL_DATABASE: hortonworks
      MYSQL_USER: hortonworks
      MYSQL_PASSWORD: password

  registry-app:
    container_name: messaging-hub-schema-registry-app
    image: thebookpeople/hortonworks-registry:latest
    ports:
      - 9090:9090
    networks:
      - dp-messaging-hub-registry-net
    environment:
      DB_NAME: hortonworks
      DB_USER: hortonworks
      DB_PASSWORD: password
      DB_PORT: 3306
      DB_HOST: registry-db
      REGISTRY_HEAP_OPTS: "-Xmx16G -Xms1G"
    depends_on:
      - registry-db

networks:
  dp-messaging-hub-registry-net:
    driver: bridge
